"use strict";(self["webpackChunkweb_client"]=self["webpackChunkweb_client"]||[]).push([[355],{5305:function(e,t,r){r.r(t),r.d(t,{default:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("div",[t("b-form-row",{staticClass:"align-items-end"},[t("b-col",[t("b-form-group",{attrs:{label:"Add a filter for the keyword","label-for":e.uniqueId("select-keyword")}},[t("v-select",{attrs:{id:e.uniqueId("select-keyword"),options:e.keywordOptions,label:"verbose_name"},model:{value:e.selectedKeyword,callback:function(t){e.selectedKeyword=t},expression:"selectedKeyword"}})],1)],1),t("b-col",{staticClass:"mb-3",attrs:{cols:"auto"}},[t("b-button",{attrs:{variant:"light",disabled:!e.selectedKeyword,title:e.selectedKeyword?`Add filter for keyword ${e.selectedKeyword.verbose_name}`:"Select a keyword to add a filter",size:"sm"},on:{click:e.addKeywordFilter}},[t("b-icon",{attrs:{icon:"plus"}})],1)],1)],1),e._l(e.keywordFilters,(function(r){return t("b-form-row",{key:r.name,staticClass:"align-items-top"},[t("b-col",["text"==r.type?t("b-form-group",{attrs:{label:`${r.verbose_name} contains`,"label-for":e.uniqueId(r.name),description:r.description}},[t("b-form-input",{attrs:{id:e.uniqueId(r.name),type:"text"},model:{value:e.filterValues[r.name],callback:function(t){e.$set(e.filterValues,r.name,t)},expression:"filterValues[keyword.name]"}})],1):"time (ISO 8601)"==r.type?t("datetime-range",{attrs:{label:`${r.verbose_name} is between`,description:r.description},model:{value:e.filterValues[r.name],callback:function(t){e.$set(e.filterValues,r.name,t)},expression:"filterValues[keyword.name]"}}):"integer"==r.type?t("number-range",{attrs:{label:`${r.verbose_name} is between`,unit:r.unit,step:"1",description:r.description},model:{value:e.filterValues[r.name],callback:function(t){e.$set(e.filterValues,r.name,t)},expression:"filterValues[keyword.name]"}}):"real"==r.type?t("number-range",{attrs:{label:`${r.verbose_name} is between`,unit:r.unit,description:r.description},model:{value:e.filterValues[r.name],callback:function(t){e.$set(e.filterValues,r.name,t)},expression:"filterValues[keyword.name]"}}):"boolean"==r.type?t("b-form-group",{attrs:{label:`${r.verbose_name} is`,description:r.description},scopedSlots:e._u([{key:"default",fn:function({ariaDescribedby:s}){return[t("b-form-radio-group",{attrs:{options:[!0,!1],"aria-describedby":s,buttons:"","button-variant":"outline-dark"},model:{value:e.filterValues[r.name],callback:function(t){e.$set(e.filterValues,r.name,t)},expression:"filterValues[keyword.name]"}})]}}],null,!0)}):e._e()],1),t("b-col",{staticClass:"mb-3",attrs:{cols:"auto"}},[t("b-button",{attrs:{variant:"light",title:`Remove filter for keyword ${r.verbose_name}`,size:"sm"},on:{click:function(t){return e.removeKeywordFilter(r)}}},[t("b-icon",{attrs:{icon:"x"}})],1)],1)],1)}))],2)},i=[],l=(r(7658),{name:"KeywordFilter",props:{value:{type:String,required:!0},keywords:{type:Array,required:!0}},data(){return{uniqueIdMap:new Map,selectedKeyword:null,selectedKeywords:Object.fromEntries(this.keywords.map((e=>[e.name,!1]))),filterValues:Object.fromEntries(this.keywords.map((e=>"integer"==e.type||"real"==e.type||"time (ISO 8601)"==e.type?[e.name,{min:null,max:null}]:[e.name,null])))}},computed:{keywordOptions(){return this.keywords.filter((e=>!this.selectedKeywords[e.name]))},keywordFilters(){return this.keywords.filter((e=>this.selectedKeywords[e.name]))}},watch:{filterValues:{handler:"updateModelValue",immediate:!0,deep:!0}},methods:{uniqueId(e){return this.uniqueIdMap.has(e)||this.uniqueIdMap.set(e,this.$utils.getUniqueId()),this.uniqueIdMap.get(e)},addKeywordFilter(){this.selectedKeyword&&(this.selectedKeywords[this.selectedKeyword.name]=!0,this.selectedKeyword=null)},removeKeywordFilter(e){this.selectedKeywords[e.name]=!1,this.selectedKeyword=e,this.updateModelValue()},updateModelValue(){let e=[];for(const t of this.keywordFilters)"text"==t.type?this.filterValues[t.name]&&e.push(`(${t.name}__icontains=${this.filterValues[t.name]})`):"integer"==t.type||"real"==t.type?(this.filterValues[t.name]?.min&&e.push(`(${t.name}__gte=${this.filterValues[t.name].min})`),this.filterValues[t.name]?.max&&e.push(`(${t.name}__lte=${this.filterValues[t.name].max})`)):"time (ISO 8601)"==t.type?(this.filterValues[t.name]?.min&&e.push(`(${t.name}__gte=${this.filterValues[t.name].min.toISOString()})`),this.filterValues[t.name]?.max&&e.push(`(${t.name}__lte=${this.filterValues[t.name].max.toISOString()})`)):"boolean"==t.type&&this.filterValues[t.name]&&e.push(`(${t.name}=${this.filterValues[t.name]})`);this.$emit("input",e.join("and"))}}}),a=l,n=r(1001),o=(0,n.Z)(a,s,i,!1,null,null,null),u=o.exports}}]);
//# sourceMappingURL=KeywordFilter.f966c4b1.js.map