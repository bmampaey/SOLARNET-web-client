<div class="row">
	<div class="col-md-4">
		<form ng-submit="update_datasets()">
			<div class="form-group">
				<label for="instruments" class="control-label">Instrument:</label>
				<multi-select
					id="instruments"
					input-model="instruments"
					output-model="selectedInstruments"
					button-label="name"
					item-label="name"
					tick-property="checked"
					helper-elements=""
					group-property="multiSelectGroup"
				/>
				
			</div>
			<div class="form-group">
				<label for="characteristics" class="control-label">Characteristics:</label>
				<multi-select
					id="characteristics"
					input-model="characteristics"
					output-model="selectedCharacteristics"
					button-label="name"
					item-label="name"
					tick-property="checked"
					helper-elements=""
					group-property="multiSelectGroup"
				/>
			</div>
			<div class="form-group">
				<label for="tags" class="control-label">Tags:</label>
				<multi-select
					id="tags"
					input-model="tags"
					output-model="selectedTags"
					button-label="name"
					item-label="name"
					tick-property="checked"
					helper-elements=""
					group-property="multiSelectGroup"
				/>
			</div>
			<div class="row">
				<label class="control-label col-md-12">Date range</label>
				<div class="form-group col-md-6" ng-class="{'has-error': start_date > end_date}">
					<label for="start_date" class="control-label">start</label>
					<div class="input-group">
						<input type="text" id="start_date" datetime-picker class="form-control" ng-model="start_date" is-open="opened_datetime_picker['start_date']" pattern="\d{4}-\d{2}-\d{2} \d{2}:\d{2}"/>
						<span class="input-group-btn">
							<button type="button" class="btn btn-default" ng-click="opened_datetime_picker['start_date'] = true" title="Click to open date picker">
								<span class="glyphicon glyphicon-calendar"></span>
							</button>
						</span>
					</div>
				</div>
				<div class="form-group col-md-6" ng-class="{'has-error': start_date > end_date}">
					<label for="end_date" class="control-label">end</label>
					<div class="input-group">
						<input type="text" id="end_date" datetime-picker class="form-control" ng-model="end_date" is-open="opened_datetime_picker['end_date']" pattern="\d{4}-\d{2}-\d{2} \d{2}:\d{2}"/>
						<span class="input-group-btn">
							<button type="button" class="btn btn-default" ng-click="opened_datetime_picker['end_date'] = true" title="Click to open date picker">
								<span class="glyphicon glyphicon-calendar"></span>
							</button>
						</span>
					</div>
				</div>
			</div>
			<div class="row">
				<label class="control-label col-md-12">Wavelength range</label>
				<div class="form-group col-md-6" ng-class="{'has-error': wavelength_min > wavelength_max}">
					<label for="wavelength_min" class="control-label">min</label>
					<div class="input-group">
						<input type="number" id="wavelength_min" class="form-control" ng-model="wavelength_min"/>
						<span class="input-group-btn">
							<button type="button" class="btn btn-default" ng-click="angstrom = !angstrom" title="Click to change from Ångström to nano meters">
								{{angstrom ? "&Aring;" : "nm"}}
							</button>
						</span>
					</div>
				</div>
				<div class="form-group col-md-6" ng-class="{'has-error': wavelength_min > wavelength_max}">
					<label for="wavelength_max" class="control-label">max</label>
					<div class="input-group">
						<input type="number" id="wavelength_max" class="form-control" ng-model="wavelength_max"/>
						<span class="input-group-btn">
							<button type="button" class="btn btn-default" ng-click="angstrom = !angstrom" title="Click to change from Ångström to nano meters">
								{{angstrom ? "&Aring;" : "nm"}}
							</button>
						</span>
					</div>
				</div>
			</div>
			<input type="submit" value="Search" class="btn btn-primary btn-md" />
		</form>
	</div>

	<div class="col-md-8">
		<table class="table table-hover table-responsive">
			<tr>
				<th>Dataset</th>
				<th># Items</th>
				<th>Instrument</th>
				<th>Telescope</th>
				<th>Characteristics</th>
			</tr>
			<tr ng-repeat="dataset in datasets" ng-hide="dataset.metadata.number_items == 0" ng-click="open_dataset(dataset)">
				<td>{{dataset.name}}</td>
				<td>{{dataset.metadata.number_items}}</td>
				<td>{{dataset.instrument}}</td>
				<td>{{dataset.telescope}}</td>
				<td>{{dataset.characteristics.join(', ')}}</td>
			</tr>
		</table>
	</div>
</div>
<div class="row">
	<uib-accordion close-others="true">
		<uib-accordion-group ng-repeat="dataset in opened_datasets" is-open="opened_accordion[dataset.id]">
			<uib-accordion-heading>
				{{ dataset.name }}
				<span uib-popover="{{dataset.description}}" popover-placement="right" popover-trigger="mouseenter" class="glyphicon glyphicon-info-sign"></span>
				<span class="pull-right glyphicon glyphicon-remove-sign" ng-click="close_dataset(dataset)"></span>
			</uib-accordion-heading>
			<div ng-include="'/static/dataset/' + dataset.id + '.html'" autoscroll ng-controller="MetadataController">
			 	Please wait while the metadata is loading...
			</div>
		</uib-accordion-group>
	</uib-accordion>
</div>