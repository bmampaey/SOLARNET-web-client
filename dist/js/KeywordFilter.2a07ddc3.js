"use strict";(self["webpackChunkweb_client"]=self["webpackChunkweb_client"]||[]).push([[2355],{4922:function(e,t,l){l.r(t),l.d(t,{default:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("div",[t("b-form-row",[t("b-col",[t("b-form-group",{attrs:{label:"Add a filter for the keyword","label-for":e.uniqueId("select-keyword")}},[t("b-form-select",{attrs:{id:e.uniqueId("select-keyword"),options:e.keywordOptions},model:{value:e.selectedKeyword,callback:function(t){e.selectedKeyword=t},expression:"selectedKeyword"}})],1)],1),t("b-col",{staticClass:"mb-3",attrs:{cols:"auto","align-self":"end"}},[t("b-button",{attrs:{variant:"light",title:e.selectedKeyword?`Add filter for keyword ${e.selectedKeyword.verbose_name}`:"Select a keyword to add a filter"},on:{click:e.addKeywordFilter}},[t("b-icon",{attrs:{icon:"plus"}})],1)],1)],1),e._l(e.keywordFilters,(function(l){return t("b-form-row",{key:l.name},[t("b-col",["text"==l.type?t("b-form-group",{attrs:{label:`${l.verbose_name} contains`,"label-for":e.uniqueId(l.name)}},[t("b-form-input",{attrs:{id:e.uniqueId(l.name),type:"text"},model:{value:e.filterValues[l.name],callback:function(t){e.$set(e.filterValues,l.name,t)},expression:"filterValues[keyword.name]"}})],1):"time (ISO 8601)"==l.type?t("datetime-range",{attrs:{label:`${l.verbose_name} is between`},model:{value:e.filterValues[l.name],callback:function(t){e.$set(e.filterValues,l.name,t)},expression:"filterValues[keyword.name]"}}):"integer"==l.type?t("number-range",{attrs:{label:`${l.verbose_name} is between`,unit:l.unit,step:"1"},model:{value:e.filterValues[l.name],callback:function(t){e.$set(e.filterValues,l.name,t)},expression:"filterValues[keyword.name]"}}):"real"==l.type?t("number-range",{attrs:{label:`${l.verbose_name} is between`,unit:l.unit},model:{value:e.filterValues[l.name],callback:function(t){e.$set(e.filterValues,l.name,t)},expression:"filterValues[keyword.name]"}}):"boolean"==l.type?t("b-form-group",{attrs:{label:`${l.verbose_name} is`},scopedSlots:e._u([{key:"default",fn:function({ariaDescribedby:a}){return[t("b-form-radio-group",{attrs:{options:[!0,!1],"aria-describedby":a,buttons:"","button-variant":"outline-dark"},model:{value:e.filterValues[l.name],callback:function(t){e.$set(e.filterValues,l.name,t)},expression:"filterValues[keyword.name]"}})]}}],null,!0)}):e._e()],1),t("b-col",{staticClass:"mb-3",attrs:{cols:"auto","align-self":"end"}},[t("b-button",{attrs:{variant:"light",title:`Remove filter for keyword ${l.verbose_name}`},on:{click:function(t){return e.removeKeywordFilter(l)}}},[t("b-icon",{attrs:{icon:"x"}})],1)],1)],1)}))],2)},r=[],s=(l(7658),{name:"KeywordFilter",props:{value:{type:String,required:!0},keywords:{type:Array,required:!0}},data(){return{uniqueIdMap:new Map,selectedKeyword:null,selectedKeywords:Object.fromEntries(this.keywords.map((e=>[e.name,!1]))),filterValues:Object.fromEntries(this.keywords.map((e=>"integer"==e.type||"real"==e.type||"time (ISO 8601)"==e.type?[e.name,{min:null,max:null}]:[e.name,null])))}},computed:{keywordOptions(){return this.keywords.filter((e=>!this.selectedKeywords[e.name])).map((e=>({text:e.verbose_name,value:e})))},keywordFilters(){return this.keywords.filter((e=>this.selectedKeywords[e.name]))}},watch:{filterValues:{handler:"updateModelValue",immediate:!0,deep:!0}},methods:{uniqueId(e){return this.uniqueIdMap.has(e)||this.uniqueIdMap.set(e,this.$utils.getUniqueId()),this.uniqueIdMap.get(e)},addKeywordFilter(){this.selectedKeyword&&(this.selectedKeywords[this.selectedKeyword.name]=!0,this.selectedKeyword=null)},removeKeywordFilter(e){this.selectedKeywords[e.name]=!1,this.selectedKeyword=e,this.updateModelValue()},updateModelValue(){let e=[];for(const t of this.keywordFilters)"text"==t.type?this.filterValues[t.name]&&e.push(`(${t.name}__icontains=${this.filterValues[t.name]})`):"integer"==t.type||"real"==t.type?(this.filterValues[t.name]?.min&&e.push(`(${t.name}__gte=${this.filterValues[t.name].min})`),this.filterValues[t.name]?.max&&e.push(`(${t.name}__lte=${this.filterValues[t.name].max})`)):"time (ISO 8601)"==t.type?(this.filterValues[t.name]?.min&&e.push(`(${t.name}__gte=${this.filterValues[t.name].min.toISOString()})`),this.filterValues[t.name]?.max&&e.push(`(${t.name}__lte=${this.filterValues[t.name].max.toISOString()})`)):"boolean"==t.type&&this.filterValues[t.name]&&e.push(`(${t.name}=${this.filterValues[t.name]})`);this.$emit("input",e.join("and"))}}}),n=s,i=l(1001),o=(0,i.Z)(n,a,r,!1,null,null,null),u=o.exports}}]);
//# sourceMappingURL=KeywordFilter.2a07ddc3.js.map