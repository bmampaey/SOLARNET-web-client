{"version":3,"file":"js/419.e59e88f5.js","mappings":"kLAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,eAAe,CAACE,MAAM,CAAC,MAAQ,OAAO,YAAYN,EAAIO,UAAU,CAACH,EAAG,gBAAgB,CAACE,MAAM,CAAC,GAAKN,EAAIO,QAAQ,MAAQP,EAAIQ,MAAM,QAAUR,EAAIS,WAAW,SAAW,IAAIC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOX,EAAIY,MAAM,QAASD,EAAOE,OAAOL,YAAY,IACvVM,EAAkB,GCMtB,G,gBAAA,CACA,mBACA,OACA,+BACA,+BAEA,gBACA,OACA,oCAGA,UACA,sBACA,0ECpBgR,I,UCO5QC,GAAY,OACd,EACAhB,EACAe,GACA,EACA,KACA,KACA,MAIF,EAAeC,EAAiB,S,0HCdhC,cACCC,WAAY,CACXC,aAAAA,EAAAA,WACAC,YAAAA,EAAAA,YAEDC,MAAO,CACNC,QAAS,CAAEC,KAAMC,OAAQC,UAAU,GACnCC,oBAAqB,CAAEH,KAAMC,OAAQC,UAAU,EAAOE,QAAS,OAEhEC,KAAM,WACL,MAAO,CACNC,aAAc,IAAIC,EAAAA,EAAqB3B,KAAKuB,qBAC5CK,aAAc,IAAIC,gBAClBC,KAAM,GACNC,SAAU,GACVC,eAAgB,CACf,CAAEC,MAAO,mBAAoBC,IAAK,WAAYC,UAAWnC,KAAKoC,OAAOC,YACrE,CAAEJ,MAAO,aAAcC,IAAK,cAI/BI,QAAS,WAERtC,KAAKuC,WACLvC,KAAKwC,gBAENC,QAAS,CACRC,mBAAoB,WACnB1C,KAAK4B,aAAe5B,KAAK0B,aAAaiB,mBAEvCJ,SAAU,WAAF,uCAAE,uHAEUvC,KAAK4C,KAAKC,IAAIC,OAAO,CAAE3B,QAASnB,KAAKmB,QAAQ4B,OAFvD,OAER/C,KAAK8B,KAFG,yDAIR9B,KAAKgD,qBAAqBhD,KAAK4C,KAAKK,WAAV,OAJlB,wDAAF,qDAAE,GAOVT,aAAc,WAAF,uCAAE,uHAEUxC,KAAK4C,KAAKM,QAAQJ,OAAO,CAAEK,cAAenD,KAAKmB,QAAQ4B,OAFjE,OAEZ/C,KAAK+B,SAFO,yDAIZ/B,KAAKgD,qBAAqBhD,KAAK4C,KAAKK,WAAV,OAJd,wDAAF,qDAAE,M,2GCvCKtB,G,gDAAAA,WAIpB,WAAYD,IAAc,mCAHnB,KAGmB,wBAFd,CAAE0B,IAAK,KAAMC,IAAK,OAGzB3B,IACC4B,MAAMC,QAAQ7B,EAAaI,QAC9B9B,KAAK8B,MAAL,OAAgBJ,EAAaI,OAE1BJ,EAAa8B,YAChBxD,KAAKwD,UAAY,CAChBJ,IAAK1B,EAAa8B,UAAUJ,IAC5BC,IAAK3B,EAAa8B,UAAUH,MAG9BrD,KAAKyD,OAAS/B,EAAa+B,Q,8CAI7B,WACC,IADiB,EACb7B,EAAe,IAAIC,gBADN,UAGC7B,KAAK8B,MAHN,IAGjB,IAAK,EAAL,qBAA6B,KAAlBe,EAAkB,QAC5BjB,EAAa8B,OAAO,WAAYb,IAJhB,8BAmBjB,OAZI7C,KAAKwD,UAAUJ,KAClBxB,EAAa+B,IAAI,gBAAiB3D,KAAKwD,UAAUJ,IAAIQ,eAGlD5D,KAAKwD,UAAUH,KAClBzB,EAAa+B,IAAI,gBAAiB3D,KAAKwD,UAAUH,IAAIO,eAGlD5D,KAAKyD,QACR7B,EAAa+B,IAAI,SAAU3D,KAAKyD,QAG1B7B,M,EAtCYD","sources":["webpack://svo/./src/components/metadata/TagSelector.vue?a922","webpack://svo/src/components/metadata/TagSelector.vue","webpack://svo/./src/components/metadata/TagSelector.vue?68d8","webpack://svo/./src/components/metadata/TagSelector.vue","webpack://svo/./src/components/metadata/MetadataMixin.js","webpack://svo/./src/services/svo/MetadataSearchFilter.js"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-form-group',{attrs:{\"label\":\"Tags\",\"label-for\":_vm.inputId}},[_c('b-form-select',{attrs:{\"id\":_vm.inputId,\"value\":_vm.value,\"options\":_vm.tagOptions,\"multiple\":\"\"},on:{\"input\":function($event){return _vm.$emit('input', $event.target.value)}}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<b-form-group label=\"Tags\" :label-for=\"inputId\">\n\t\t<b-form-select :id=\"inputId\" :value=\"value\" :options=\"tagOptions\" multiple @input=\"$emit('input', $event.target.value)\"></b-form-select>\n\t</b-form-group>\n</template>\n\n<script>\nexport default {\n\tname: 'TagSelector',\n\tprops: {\n\t\tvalue: { type: Array, required: true },\n\t\ttags: { type: Array, required: true }\n\t},\n\tdata: function() {\n\t\treturn {\n\t\t\tinputId: this.$utils.getUniqueId()\n\t\t};\n\t},\n\tcomputed: {\n\t\ttagOptions: function() {\n\t\t\treturn this.tags.map(tag => ({ value: tag.name, text: tag.name }));\n\t\t}\n\t}\n};\n</script>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./TagSelector.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./TagSelector.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TagSelector.vue?vue&type=template&id=2c08fbea&\"\nimport script from \"./TagSelector.vue?vue&type=script&lang=js&\"\nexport * from \"./TagSelector.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import MetadataList from './MetadataList';\nimport TagSelector from './TagSelector';\nimport MetadataSearchFilter from '@/services/svo/MetadataSearchFilter';\n\nexport default {\n\tcomponents: {\n\t\tMetadataList,\n\t\tTagSelector\n\t},\n\tprops: {\n\t\tdataset: { type: Object, required: true },\n\t\tinitialSearchFilter: { type: Object, required: false, default: null }\n\t},\n\tdata: function() {\n\t\treturn {\n\t\t\tsearchFilter: new MetadataSearchFilter(this.initialSearchFilter),\n\t\t\tsearchParams: new URLSearchParams(),\n\t\t\ttags: [],\n\t\t\tkeywords: [],\n\t\t\tdefaultColumns: [\n\t\t\t\t{ label: 'Observation date', key: 'date_beg', formatter: this.$utils.formatDate },\n\t\t\t\t{ label: 'Wavelength', key: 'wavemin' }\n\t\t\t]\n\t\t};\n\t},\n\tcreated: function() {\n\t\t// Fetch and create the options of the form select\n\t\tthis.loadTags();\n\t\tthis.loadKeywords();\n\t},\n\tmethods: {\n\t\tupdateSearchParams: function() {\n\t\t\tthis.searchParams = this.searchFilter.getSearchParams();\n\t\t},\n\t\tloadTags: async function() {\n\t\t\ttry {\n\t\t\t\tthis.tags = await this.$SVO.tag.getAll({ dataset: this.dataset.name });\n\t\t\t} catch (error) {\n\t\t\t\tthis.$displayErrorMessage(this.$SVO.parseError(error));\n\t\t\t}\n\t\t},\n\t\tloadKeywords: async function() {\n\t\t\ttry {\n\t\t\t\tthis.keywords = await this.$SVO.keyword.getAll({ dataset__name: this.dataset.name });\n\t\t\t} catch (error) {\n\t\t\t\tthis.$displayErrorMessage(this.$SVO.parseError(error));\n\t\t\t}\n\t\t}\n\t}\n};\n","/* The SearchFilter is the interface between the API and the search form data */\n\nexport default class MetadataSearchFilter {\n\ttags = [];\n\tdateRange = { min: null, max: null };\n\n\tconstructor(searchFilter) {\n\t\tif (searchFilter) {\n\t\t\tif (Array.isArray(searchFilter.tags)) {\n\t\t\t\tthis.tags = [...searchFilter.tags];\n\t\t\t}\n\t\t\tif (searchFilter.dateRange) {\n\t\t\t\tthis.dateRange = {\n\t\t\t\t\tmin: searchFilter.dateRange.min,\n\t\t\t\t\tmax: searchFilter.dateRange.max\n\t\t\t\t};\n\t\t\t}\n\t\t\tthis.search = searchFilter.search;\n\t\t}\n\t}\n\n\tgetSearchParams() {\n\t\tlet searchParams = new URLSearchParams();\n\n\t\tfor (const tag of this.tags) {\n\t\t\tsearchParams.append('tags__in', tag);\n\t\t}\n\n\t\tif (this.dateRange.min) {\n\t\t\tsearchParams.set('date_end__gte', this.dateRange.min.toISOString());\n\t\t}\n\n\t\tif (this.dateRange.max) {\n\t\t\tsearchParams.set('date_beg__lte', this.dateRange.max.toISOString());\n\t\t}\n\n\t\tif (this.search) {\n\t\t\tsearchParams.set('search', this.search);\n\t\t}\n\n\t\treturn searchParams;\n\t}\n}\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","inputId","value","tagOptions","on","$event","$emit","target","staticRenderFns","component","components","MetadataList","TagSelector","props","dataset","type","Object","required","initialSearchFilter","default","data","searchFilter","MetadataSearchFilter","searchParams","URLSearchParams","tags","keywords","defaultColumns","label","key","formatter","$utils","formatDate","created","loadTags","loadKeywords","methods","updateSearchParams","getSearchParams","$SVO","tag","getAll","name","$displayErrorMessage","parseError","keyword","dataset__name","min","max","Array","isArray","dateRange","search","append","set","toISOString"],"sourceRoot":""}